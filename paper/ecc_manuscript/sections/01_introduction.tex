\section{Introduction}

Many processes in the chemical and petrochemical sectors involve states that evolve over space and time, commonly represented by partial differential equations (PDEs) as distributed parameter systems (DPS) \cite{ray1981advanced}. 
The infinite-dimensional nature of DPSs presents specific challenges in control and estimation, making this a prominent area of research. Two main methods are often applied to control DPSs: \textit{Early Lumping} and \textit{Late Lumping}. 
Early Lumping reduces the system to a finite-dimensional approximation through spatial discretization early in the modeling stage, allowing for the application of standard control techniques \cite{davison1976robust}. 
However, this method can lead to inaccuracies due to mismatches between the reduced model and the original system dynamics \cite{moghadam2012infinite}. 
Late Lumping, by contrast, preserves the system's infinite-dimensional structure until the final stages of controller implementation, resulting in a control approach that is more complex but achieves greater fidelity to the original dynamics.

A range of studies in chemical engineering have applied the late lumping method to control infinite-dimensional systems, specifically targeting convection-reaction processes governed by first-order hyperbolic PDEs and diffusion-convection-reaction processes described by second-order parabolic PDEs. 
In \cite{christofides1996feedback}, the robust control of first-order hyperbolic PDEs is explored, demonstrating the stabilization of a plug flow reactor system using a distributed input. 
A boundary feedback stabilization approach using the backstepping method is presented in \cite{krstic2008backstepping} for a comparable system of first-order hyperbolic PDEs. 
The work in \cite{xu2016state} introduces a state feedback regulator design for a countercurrent heat exchanger system, providing another example of a chemical engineering DPS governed by first-order hyperbolic PDEs, distinct from tubular reaction systems. 
Highlighting the role of dispersion in axial dispersion tubular reactors, \cite{christofides1998robust} examines the robust control of diffusion-convection-reaction systems governed by second-order parabolic PDEs. 
In \cite{dubljevic2006predictive2}, a late-lumping approach is employed to develop a low-dimensional predictive controller for a diffusion-convection-reaction system, utilizing modal decomposition to capture the system's dominant modes. 
A similar method is applied in \cite{khatibi2021model} to design an observer-based model predictive controller (MPC) for an axial dispersion tubular reactor, accounting for the impact of recycle streams, a common feature in industrial chemical reactors. 
Different aspects of state reconstruction for DPSs are addressed in several works where the design of a discrete-time Luenberger observer is adressed for the class of DPSs, where no spatial discretization is required; a key feature of the late lumping approach  \cite{dochain2000state, dochain2001state, alonso2004optimal, ali2015review}.

In addition to dynamic systems distributed over space, dynamic systems that exhibit time delays are also classified as DPSs \cite{curtainbook}. 
In the field of control theory for infinite-dimensional systems, delay systems are either represented as delay differential equations (DDEs) or as transport PDEs, with the latter being advantageous in more complex scenarios, e.g. in the presence of spatial dynamics \cite{krstic2009book}. 
When it comes to chemical engineering applications of control theory, delays are often introduced as the result of input or output delays, while state delays are less frequently addressed in the literature; most probably since not many applications in this field can be described by state delays, in contrast with other domains of control theory, such as signal processing or mechanical systems. 
Input/output delays are generally handled by introducing a transportation lag block at either the input or output of the system, leading to a cascade PDE system \cite{Hiratsuka1969IEEE, mohammadi2012lq, Guilherme2019ACC}. 
In one of the few studies addressing state delays in this area, \cite{ozorio2019heat} investigates a delayed-state distributed parameter system where a full-state and output feedback regulator is designed for a heat exchanger system. 
Here, the state delay arises from the time taken for a stream to exit one pass of the heat exchanger and enter the next. 
Similarly, in \cite{qi2021output}, a tubular reactor system is considered, where state delay is introduced by the recycle delay in the system, without accounting for the diffusion term along the reactor. 
Even in \cite{khatibi2021model}, where a recycle stream is incorporated for a distributed diffusion-convection-reaction system, the recycle is assumed to be instantaneousâ€”an assumption that creates a gap in the literature on diffusion-convection-reaction systems with recycle streams that impose a state delay.

In this work, an axial dispersion tubular reactor equipped with recycle is addressed as a diffusion-convection-reaction DPS. First, the reactor is modeled by a second order parabolic PDE, where the recycle stream poses a state delay, resulting in a first order hyperbolic transport PDE. 
Therefore, a system of coupled hyperbolic and parabolic PDEs is obtained to describe the infinite-dimensional model of the plant. 
The resolvent operator of the system is then obtained in an exact closed form, omitting the need for spatial discretization following the late lumping approach. 
The continous-time system is then discrtetized to enable the implementation of MPC as a digital controller. This is done using Caley-Tustin time discretization technique, i.e. a Crank-Nicolson type of discretization that preserves the conservative characteristics of the continuous system, mitigating the need for model reduction \cite{havu2007cayley, xu2017linear}. 
An infinite-dimensional Luenberger observer is also designed to reconstruct the states of the system, addressing the controller's limited access to system's full-state. 
As a result, through numerical simulations, the observer-based output feedback MPC is shown to successfully stabilize a system while adhering to input constraints, despite the original system being unstable.