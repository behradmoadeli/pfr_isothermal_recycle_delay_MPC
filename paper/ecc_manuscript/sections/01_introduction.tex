\section{Introduction}

Many processes in the chemical and petrochemical sectors involve states that evolve over space and time, commonly represented by partial differential equations (PDEs) as distributed parameter systems (DPS) \cite{ray1981advanced}. The infinite-dimensional nature of DPSs presents specific challenges in control and estimation, making this a prominent area of research. Two main methods are often applied to control DPSs: \textit{Early Lumping} and \textit{Late Lumping}. Early Lumping reduces the system to a finite-dimensional approximation through spatial discretization early in the modeling stage, allowing for the application of standard control techniques \cite{davison1976robust}. However, this method can lead to inaccuracies due to mismatches between the reduced model and the original system dynamics \cite{moghadam2012infinite}. Late Lumping, by contrast, preserves the systemâ€™s infinite-dimensional structure until the final stages of controller implementation, resulting in a control approach that is more complex but achieves greater fidelity to the original dynamics.

A range of studies in chemical engineering have applied the late lumping method to control infinite-dimensional systems, specifically targeting convection-reaction processes governed by first-order hyperbolic PDEs and diffusion-convection-reaction processes described by second-order parabolic PDEs.
In \cite{christofides1996feedback}, the robust control of first-order hyperbolic PDEs is explored, demonstrating the stabilization of a plug flow reactor system using a distributed input.
A boundary feedback stabilization approach using the backstepping method is presented in \cite{krstic2008backstepping} for a comparable system of first-order hyperbolic PDEs.
The work in \cite{xu2016state} introduces a state feedback regulator design for a countercurrent heat exchanger system, providing another example of a chemical engineering DPS governed by first-order hyperbolic PDEs, distinct from tubular reaction systems.
Highlighting the role of dispersion in axial dispersion tubular reactors, \cite{christofides1998robust} examines the robust control of diffusion-convection-reaction systems governed by second-order parabolic PDEs.
In \cite{dubljevic2006predictive2}, a late-lumping approach is employed to develop a low-dimensional predictive controller for a diffusion-convection-reaction system, utilizing modal decomposition to capture the system's dominant modes.
A similar method is applied in \cite{khatibi2021model} to design an observer-based model predictive controller (MPC) for an axial dispersion tubular reactor, accounting for the impact of recycle streams, a common feature in industrial chemical reactors.
Different aspects of state reconstruction for DPSs are addressed in several works where the design of a discrete-time Luenberger observer is adressed for the class of DPSs, where no spatial discretization is required; a key feature of the late lumping approach  \cite{dochain2000state, dochain2001state, alonso2004optimal, ali2015review}.
%%% ta inja
Delay systems are another class of infinite-dimensional systems that have been studied in the literature \cite{curtainbook}. 
Commonly represented in the form of delay differential equations (DDEs), delay can also be modeled as a transport PDE, showing to be advantageous in more complex scenarios \cite{krstic2009book}. In the field of control theory for chemical engineering DPSs, input/output delay has been addressed in several works as both output measurement delays and input actuation delays are common in industrial processes. 
In general, such delays can be addressed by considering a transportation lag block at either the input or output of the system, resulting in a cascade PDE system \cite{Hiratsuka1969IEEE, mohammadi2012lq, Guilherme2019ACC}. In contrast to input/output delays, state delay is less addressed in the relevant literature, probably since not many applications in this field can be described by state delays. In one of the few attempts, a delayed-state distributed parameter system is addressed in \cite{ozorio2019heat}, where a full-state and output feedback regulator is designed for a system of heat exchangers. The state delay in this works comes from the time it takes for a stream to leave one pass of the heat exchanger and enter the next pass. Similarly in \cite{qi2021output}, a tubular reactor system is considered, where the state delay is introduced as a result of the recycle delay in the system, without considering the diffusion term along the reactor. Even in \cite{khatibi2021model} where the recycle stream is considered for a distributed diffusion-convection-reaction system, the recycle is assumed to be instantaneous; a simplifying assumption that leaves a gap in the literature regarding diffusion-convection-reaction systems with a recycle stream imposing state delay.

In this work, an axial dispersion tubular reactor equipped with recycle is addressed as a diffusion-convection-reaction DPS. First, the reactor is modeled by a second order parabolic PDE, where the recycle stream poses a state delay, resulting in a first order hyperbolic transport PDE coupled with the original PDE. Late lumping approach is utilized by obtaining the resolvent of the infinite-dimensional system in a closed operator form, with no need to perform spatial discretization. Then, to enable the implementation of MPC as a digital controller, discrete-time representation of the system is obtained using Caley-Tustin time discretization technique; i.e. a Crank-Nicolson type of discretization that preserves the conservative characteristics of the continuous system, mitigating the need for model reduction \cite{havu2007cayley, xu2017linear}. Finally via numerical simulations, the proposed controller is shown to stabilize an unstable system within an optimal framework, given input constraints.